<!--
HW7 – Part 2: Remember Me With Cookies
- First visit in a browser session: show a form to collect
  the user's full name and username, then save them in
  two session cookies.
- If cookies exist (user revisits the page while the browser
  is still open), hide the form and show only a
  “Welcome back” message using the stored name/username.
- Cookies are session cookies, so they
  are deleted when the browser is fully closed.
-->

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="description" content="CIS 114 - HW7 Part 2 (Object Model and Cookies)">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HW7 – Part 2 (Remember Me with Cookies)</title>

  <style>
    :root { --btn:#4b3f4e; --btnHover:#6a5d6e; --bgSize:640px auto; }
    html, body { height:100%; margin:0; }
    *, *::before, *::after { box-sizing:border-box; }

    body {
      font-family: Arial, sans-serif;
      color:#000;
      background:#fff;
      padding:24px;
      position:relative;
      overflow-x:hidden;
    }

    body::before {
      content:"";
      position:fixed;
      inset:0;
      background:url("desk-art.png") no-repeat right bottom / var(--bgSize);
      z-index:-2;
      pointer-events:none;
    }
    body::after {
      content:"";
      position:fixed;
      inset:0;
      background:rgba(255,255,255,.18);
      z-index:-1;
      pointer-events:none;
    }

    h1 { margin:0 0 16px; }

    nav a {
      display:inline-block;
      margin:6px 8px 16px 0;
      padding:10px 14px;
      background:var(--btn);
      color:#fff;
      text-decoration:none;
      border-radius:6px;
      transition:background-color .2s ease;
    }
    nav a:hover { background:var(--btnHover); }

    .wrap {
      background:rgba(255,255,255,.85);
      padding:16px;
      border-radius:10px;
      max-width:720px;
      box-shadow:0 2px 10px rgba(0,0,0,.06);
    }

    .field {
      margin-bottom:12px;
    }
    .field label {
      display:block;
      margin-bottom:4px;
      font-weight:700;
    }
    .field input[type="text"] {
      width:100%;
      padding:8px 10px;
      border:1px solid #ccc;
      border-radius:6px;
    }

    button {
      padding:10px 14px;
      border:none;
      border-radius:6px;
      cursor:pointer;
      background:var(--btn);
      color:#fff;
      transition:background-color .2s ease;
    }
    button:hover { background:var(--btnHover); }

    .error {
      color:#b00020;
      font-weight:600;
      margin-top:10px;
    }

    .welcome {
      padding:12px 10px;
      border-radius:8px;
      background:#f7f7f7;
      margin-top:8px;
    }

    @media (max-width:1024px){ :root { --bgSize:500px auto; } }
    @media (max-width:768px) { :root { --bgSize:350px auto; } }
    @media (max-width:480px){
      :root { --bgSize:250px auto; }
      body::before { position:absolute; } /* iOS fix */
    }
  </style>
</head>
<body>
  <h1>Remember Me With Cookies</h1>

  <nav aria-label="HW7 navigation">
    <a href="hw7.html">HW7 Home</a>
    <a href="index.html">Homework 1 (Course Home)</a>
  </nav>

  <section class="wrap" aria-label="User registration with cookies">
    <!-- First-visit form -->
    <div id="formContainer">
      <h2>Register for this session</h2>
      <form id="regForm" novalidate>
        <div class="field">
          <label for="fullName">Full name</label>
          <input id="fullName" name="fullName" type="text">
        </div>
        <div class="field">
          <label for="username">Username</label>
          <input id="username" name="username" type="text">
        </div>
        <button type="button" id="saveBtn">Save</button>
      </form>
      <p id="msg" class="error" aria-live="polite"></p>
    </div>

    <!-- Returning-visit view -->
    <div id="welcomeContainer" class="welcome" hidden aria-live="polite">
      <h2>Welcome back!</h2>
      <p id="welcomeText"></p>
    </div>
  </section>

  <script>
    // Create a SESSION cookie
    function setSessionCookie(name, value) {
      document.cookie = name + "=" + encodeURIComponent(value) + "; path=/";
    }

    // Read document.cookie into a simple object.
    function getCookieMap() {
      var map = {};
      var all = document.cookie;
      if (!all) return map;

      var parts = all.split(";");
      parts.forEach(function (part) {
        var pair = part.trim().split("=");
        if (!pair[0]) return;
        var key = decodeURIComponent(pair[0]);
        var val = pair[1] ? decodeURIComponent(pair[1]) : "";
        map[key] = val;
      });
      return map;
    }

    // -----------------------------
    // UI helpers
    // -----------------------------
    var formContainer    = document.getElementById("formContainer");
    var welcomeContainer = document.getElementById("welcomeContainer");
    var welcomeText      = document.getElementById("welcomeText");
    var msg              = document.getElementById("msg");
    var fullNameInput    = document.getElementById("fullName");
    var usernameInput    = document.getElementById("username");

    function showForm() {
      formContainer.hidden = false;
      welcomeContainer.hidden = true;
      msg.textContent = "";
    }

    function showWelcome(name, username) {
      var text = "Welcome back, " + name;
      if (username) {
        text += " (" + username + ")";
      }
      text += "!";
      welcomeText.textContent = text;

      formContainer.hidden = true;
      welcomeContainer.hidden = false;
      msg.textContent = "";
    }

    // -----------------------------
    // On load: decide which view to show
    // -----------------------------
    (function init() {
      var cookies   = getCookieMap();
      var savedName = cookies.hw7_name;
      var savedUser = cookies.hw7_username;

      if (savedName && savedName.trim().length > 0) {
        // Returning within the same browser session
        showWelcome(savedName, savedUser || "");
      } else {
        // First visit in this browser session
        showForm();
      }
    })();


    document.getElementById("saveBtn").addEventListener("click", function () {
      msg.textContent = "";

      var nameVal = fullNameInput.value.trim();
      var userVal = usernameInput.value.trim();

      if (!nameVal || !userVal) {
        msg.textContent = "Please enter both your full name and your username.";
        return;
      }

      // Store both values as session cookies
      setSessionCookie("hw7_name", nameVal);
      setSessionCookie("hw7_username", userVal);

      // Immediately switch to the welcome view
      showWelcome(nameVal, userVal);
    });
  </script>
</body>
</html>

