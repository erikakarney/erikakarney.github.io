<!--
HW6 – Part 2: Character Finder
- User types a big chunk of text and a single letter.
- Case-insensitive search counts occurrences.
- If 0 matches, opens a 300x100 window positioned so it doesn’t cover the main form,
  with a Close button. Also clears the result area on the main page.
-->

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="description" content="CIS 114 - HW6 Part 2 (Objects: string methods & window.open)">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HW6 – Part 2 (Character Finder)</title>
  <style>
    :root { --btn:#4b3f4e; --btnHover:#6a5d6e; --bgSize:640px auto; }
    html,body{height:100%;margin:0} 
    *,*::before,*::after{box-sizing:border-box}

    body{font-family:Arial,sans-serif;
        color:#000;background:#fff;
        padding:24px;position:relative;overflow-x:hidden
    }

    body::before{content:"";position:fixed;inset:0;
        background:url("desk-art.png") no-repeat right bottom/var(--bgSize);
        z-index:-2;pointer-events:none}
    body::after{content:"";position:fixed;inset:0;
        background:rgba(255,255,255,.18);
        z-index:-1;pointer-events:none}
    h1{margin:0 0 12px}
    nav a{display:inline-block;margin:6px 8px 16px 0;padding:10px 14px;background:var(--btn);color:#fff;text-decoration:none;border-radius:6px;transition:background-color .2s}
    nav a:hover{background:var(--btnHover)}
    form{background:rgba(255,255,255,.85);padding:16px;border-radius:10px;max-width:820px;box-shadow:0 2px 10px rgba(0,0,0,.06)}
    .row{display:flex;gap:10px;align-items:center;margin:8px 0}
    label{font-weight:700}
    textarea{width:100%;min-height:150px;padding:10px;border:1px solid #ccc;border-radius:8px}
    input[type="text"]{padding:8px 10px;border:1px solid #ccc;border-radius:6px;width:70px;text-align:center}
    .buttons{display:flex;gap:10px;margin-top:10px}
    button{padding:10px 14px;border:none;border-radius:6px;cursor:pointer;background:var(--btn);color:#fff;transition:background-color .2s}
    button:hover{background:var(--btnHover)}
    #out{margin-top:14px;padding:12px;background:#f7f7f7;border-radius:8px;white-space:pre-line}
    .error{color:#b00020;font-weight:700}
    @media (max-width:1024px){:root{--bgSize:500px auto}}
    @media (max-width:768px){:root{--bgSize:350px auto}}
    @media (max-width:480px){:root{--bgSize:250px auto} body::before{position:absolute}}
  </style>
</head>
<body>
  <h1>Character Finder</h1>

  <nav aria-label="HW6 navigation">
    <a href="hw6.html">← HW6 Home</a>
    <a href="index.html">Homework 1 (Course Home)</a>
  </nav>

  <form id="finder" novalidate>
    <div class="row">
      <label for="content">Your content</label>
    </div>
    <div class="row">
      <textarea id="content" name="content" placeholder="Type a few sentences here..."></textarea>
    </div>

    <div class="row">
      <label for="ch">Search for a single letter</label>
      <input id="ch" name="ch" type="text" maxlength="1" placeholder="e.g., t">
    </div>

    <div class="buttons">
      <button type="button" id="searchBtn">Submit</button>
      <button type="button" id="clearBtn">Clear</button>
    </div>

    <div id="out" aria-live="polite"></div>
  </form>

  <script>
    function show(text, isError){
      document.getElementById('out').innerHTML = isError
        ? '<p class="error">'+text+'</p>' : text;
    }

    // Count occurrences of a single character inside a string
    function countChar(haystack, needle){
      if(!needle) return 0;
      var h = (haystack || "").toLowerCase();
      var n = needle.toLowerCase();
      var count = 0;
      for (var i = 0; i < h.length; i++){
        if (h[i] === n) count++;
      }
      return count;
    }

    // Open a small window (300x100) with a message + Close button
    function openNotFoundWindow(letter){
      // Placed near top-left so it won’t obscure the main form
      var features = "width=300,height=100,left=40,top=40,resizable=no";
      var w = window.open("", "notfound", features);
      if (!w) return; // popup blocked
      w.document.write(
        '<!DOCTYPE html><html><head><title>Not found</title>' +
        '<meta charset="UTF-8"><style>body{font-family:Arial,sans-serif;margin:10px}button{margin-top:10px;padding:6px 10px}</style></head><body>' +
        '<p>Search character <strong>' + letter + '</strong> not found in the content you typed.</p>' +
        '<button onclick="window.close()">Close</button>' +
        '</body></html>'
      );
      w.document.close();
      w.focus();
    }

    document.getElementById('searchBtn').addEventListener('click', function(){
      var content = document.getElementById('content').value;
      var ch = document.getElementById('ch').value.trim();

      // Validate: must have at least 1 char of content and exactly 1 search letter
      if(!content.trim()){
        show('Please type some content to search.', true);
        return;
      }
      if(ch.length !== 1){
        show('Please type exactly one letter to search.', true);
        return;
      }

      var hits = countChar(content, ch);
      if(hits > 0){
        show('The character "' + ch + '" appears ' + hits + ' time' + (hits===1?'':'s') + ' in your content.');
      }else{
        // Clear any previous positive result and open the small window
        show('');
        openNotFoundWindow(ch);
      }
    });

    document.getElementById('clearBtn').addEventListener('click', function(){
      document.getElementById('content').value = "";
      document.getElementById('ch').value = "";
      show('');
      document.getElementById('content').focus();
    });
  </script>
</body>
</html>
